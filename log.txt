C:\ProgramData\anaconda3\Lib\site-packages\transformers\utils\generic.py:260: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
2025-04-04 17:49:52,597 - INFO - 模型文件已存在，加载本地模型。
2025-04-04 17:49:52,597 - INFO - 正在加载模型: ./models/onnx-community/distilbert-base-uncased-finetuned-sst-2-english-ONNX
2025-04-04 17:49:54,044 - INFO - 成功加载模型: ./models/onnx-community/distilbert-base-uncased-finetuned-sst-2-english-ONNX
2025-04-04 17:49:54,046 - INFO - 加载本地股票列表数据: stock_data\stock_list.csv
2025-04-04 17:49:54,067 - INFO - 获取到A股股票列表：
2025-04-04 17:49:54,067 - INFO -      code   name
0  000001   平安银行
1  000002  万  科Ａ
2  000004   国华网安
3  000006   深振业Ａ
4  000007    全新好
2025-04-04 17:49:54,084 - INFO - 正在训练 东富龙（300171）的模型...
2025-04-04 17:49:54,123 - INFO - 本地数据已覆盖所需时间范围，直接返回本地数据。
2025-04-04 17:49:54,127 - INFO - 加载本地新闻数据: stock_data\financial_news.csv
2025-04-04 17:49:56,327 - INFO - 新闻数据已更新并保存到本地: stock_data\financial_news.csv
2025-04-04 17:49:56,349 - INFO - 检查训练模型的数据...
2025-04-04 17:49:56,349 - INFO - 获取沪深300指数数据...
2025-04-04 17:49:56,349 - INFO - 加载本地沪深300指数数据: stock_data\hs300.csv
2025-04-04 17:49:56,375 - INFO - 本地数据已覆盖所需时间范围，直接返回本地数据。
2025-04-04 17:49:56,377 - INFO - 获取板块训练数据...
2025-04-04 17:49:56,379 - INFO - 加载本地行业信息缓存数据...
2025-04-04 17:49:57,020 - INFO - 股票 300171 行业信息: 医疗器械
2025-04-04 17:49:57,022 - INFO - 获取股票财务数据...
2025-04-04 17:49:57,022 - INFO - 加载本地财务数据: stock_data\300171_financial.csv
2025-04-04 17:49:57,033 - INFO - 本地数据已覆盖所需时间范围，直接返回本地数据。
2025-04-04 17:49:57,036 - INFO - 数据预处理...
2025-04-04 17:49:57,036 - INFO - 股票数据长度: 242
2025-04-04 17:49:57,036 - INFO - 沪深300指数数据长度: 242
2025-04-04 17:49:57,036 - INFO - 行业数据长度: 1
2025-04-04 17:49:57,036 - INFO - 财务数据长度: 4
2025-04-04 17:49:57,036 - INFO - 情感特征数据长度: 0
2025-04-04 17:49:57,061 - INFO - 合并后的股票和指数数据已保存到本地文件：merged_stock_index_data.csv
2025-04-04 17:49:57,138 - INFO - 合并后的股票和财务数据已保存到本地文件：merged_stock_financial_data.csv
2025-04-04 17:49:57,142 - WARNING - 情感特征为空，填充默认值。
2025-04-04 17:49:57,166 - INFO - 合并后的股票和情感数据已保存到本地文件：merged_stock_sentiment_data.csv
2025-04-04 17:49:57,182 - INFO - 创建特征工程...
2025-04-04 17:49:57,197 - INFO - 动态生成 Future_Return 列
2025-04-04 17:49:57,199 - INFO - 分析特征重要性...
2025-04-04 17:49:58,182 - INFO - 特征重要性：
2025-04-04 17:49:58,182 - INFO - RSI                              0.212984
Bollinger_Mid                    0.165041
MACD_Histogram                   0.107273
Volatility                       0.095410
ATR                              0.089530
MACD_DEA                         0.086378
MACD_DIF                         0.063037
OBV                              0.052908
MA_50                            0.043409
MA_20                            0.037838
MA_10                            0.035418
Net_Profit_Growth                0.005020
Debt_to_Asset_Ratio              0.003609
ROE                              0.002145
Gross_Margin                     0.000000
snownlp_sentiment_mean           0.000000
snownlp_sentiment_std            0.000000
snownlp_sentiment_count          0.000000
textblob_sentiment_mean          0.000000
textblob_sentiment_std           0.000000
bert_sentiment_mean              0.000000
bert_sentiment_std               0.000000
snownlp_sentiment_volatility     0.000000
textblob_sentiment_volatility    0.000000
bert_sentiment_volatility        0.000000
dtype: float64
2025-04-04 17:50:03,370 - INFO - 特征重要性：
2025-04-04 17:50:03,370 - INFO - {'RSI': 0.2129844022902241, 'Bollinger_Mid': 0.16504079698575147, 'MACD_Histogram': 0.1072731968529456, 'Volatility': 0.09541019721013426, 'ATR': 0.0895296532361062, 'MACD_DEA': 0.08637784195914815, 'MACD_DIF': 0.0630365007115426, 'OBV': 0.05290806853831155, 'MA_50': 0.04340936268238175, 'MA_20': 0.03783808980024762, 'MA_10': 0.035418019705465875, 'Net_Profit_Growth': 0.005020347723326043, 'Debt_to_Asset_Ratio': 0.0036088279073957664, 'ROE': 0.002144694397019098, 'Gross_Margin': 0.0, 'snownlp_sentiment_mean': 0.0, 'snownlp_sentiment_std': 0.0, 'snownlp_sentiment_count': 0.0, 'textblob_sentiment_mean': 0.0, 'textblob_sentiment_std': 0.0, 'bert_sentiment_mean': 0.0, 'bert_sentiment_std': 0.0, 'snownlp_sentiment_volatility': 0.0, 'textblob_sentiment_volatility': 0.0, 'bert_sentiment_volatility': 0.0}
2025-04-04 17:50:03,370 - INFO - 进行 SHAP 值分析...
2025-04-04 17:50:10,051 - INFO - SHAP 特征重要性：
2025-04-04 17:50:10,051 - INFO - RSI                              0.000134
Net_Profit_Growth                0.000004
Gross_Margin                     0.000000
textblob_sentiment_volatility    0.000000
snownlp_sentiment_volatility     0.000000
bert_sentiment_std               0.000000
bert_sentiment_mean              0.000000
textblob_sentiment_std           0.000000
textblob_sentiment_mean          0.000000
snownlp_sentiment_count          0.000000
snownlp_sentiment_std            0.000000
snownlp_sentiment_mean           0.000000
bert_sentiment_volatility        0.000000
ROE                             -0.000004
Debt_to_Asset_Ratio             -0.000006
MA_20                           -0.000012
MA_50                           -0.000046
MA_10                           -0.000082
OBV                             -0.000200
Volatility                      -0.000245
Bollinger_Mid                   -0.000357
MACD_DIF                        -0.000426
MACD_DEA                        -0.000528
MACD_Histogram                  -0.000792
ATR                             -0.001171
dtype: float64
2025-04-04 17:50:10,058 - INFO - SHAP 特征重要性：
2025-04-04 17:50:10,058 - INFO - ['RSI', 'Net_Profit_Growth']
2025-04-04 17:50:10,058 - INFO - 绘制特征相关性热力图...
2025-04-04 17:50:10,069 - INFO - 已加载特征选择文件 models\selected_features.pkl
2025-04-04 17:50:12,117 - INFO - 高相关性特征对：
2025-04-04 17:50:12,117 - INFO - [('MA_10', 'MA_20', 0.9933129552654449), ('MA_10', 'MA_50', 0.9749542746297571), ('MA_10', 'OBV', 0.850706623613733), ('MA_10', 'ROE', -0.8244944452774234), ('MA_20', 'MA_10', 0.9933129552654449), ('MA_20', 'MA_50', 0.9868691942177288), ('MA_20', 'OBV', 0.8448902675171724), ('MA_20', 'ROE', -0.8274186213188701), ('MA_50', 'MA_10', 0.9749542746297571), ('MA_50', 'MA_20', 0.9868691942177288), ('MA_50', 'OBV', 0.8187574386320278), ('MA_50', 'ROE', -0.8036395213305203), ('MACD_DIF', 'MACD_DEA', 0.907851529891888), ('MACD_DEA', 'MACD_DIF', 0.907851529891888), ('OBV', 'MA_10', 0.850706623613733), ('OBV', 'MA_20', 0.8448902675171724), ('OBV', 'MA_50', 0.8187574386320278), ('OBV', 'ROE', -0.8281134731607805), ('ROE', 'MA_10', -0.8244944452774234), ('ROE', 'MA_20', -0.8274186213188701), ('ROE', 'MA_50', -0.8036395213305203), ('ROE', 'OBV', -0.8281134731607805), ('ROE', 'Debt_to_Asset_Ratio', 0.8050825141499419), ('Debt_to_Asset_Ratio', 'ROE', 0.8050825141499419)]
2025-04-04 17:50:12,124 - INFO - 高相关性特征对：
2025-04-04 17:50:12,124 - INFO -                   RSI  ...  bert_sentiment_volatility
Date                   ...                           
2023-01-03   0.000000  ...                          0
2023-01-04   0.000000  ...                          0
2023-01-05   0.000000  ...                          0
2023-01-06   0.000000  ...                          0
2023-01-09   0.000000  ...                          0
...               ...  ...                        ...
2023-12-25  29.292929  ...                          0
2023-12-26  35.922330  ...                          0
2023-12-27  36.156352  ...                          0
2023-12-28  36.893204  ...                          0
2023-12-29  36.274510  ...                          0

[242 rows x 17 columns]
2025-04-04 17:50:17,783 - INFO - Fold 1, Epoch 1: Train Loss 0.0036, Val Loss 0.0017, Train R2 -1.1258, Val R2 -0.2791
2025-04-04 17:50:17,783 - INFO - R²差异: 0.8467
2025-04-04 17:50:17,783 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:17,783 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:17,831 - INFO - Fold 1, Epoch 2: Train Loss 0.0021, Val Loss 0.0013, Train R2 -0.2611, Val R2 0.0176
2025-04-04 17:50:17,831 - INFO - R²差异: 0.2787
2025-04-04 17:50:17,831 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:17,831 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:17,875 - INFO - Fold 1, Epoch 3: Train Loss 0.0032, Val Loss 0.0022, Train R2 -0.9352, Val R2 -0.6796
2025-04-04 17:50:17,875 - INFO - R²差异: 0.2556
2025-04-04 17:50:17,875 - INFO - R²差异超过阈值，重置模型（第 3 次）
2025-04-04 17:50:17,875 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:17,921 - INFO - Fold 1, Epoch 4: Train Loss 0.0018, Val Loss 0.0014, Train R2 -0.0600, Val R2 -0.0599
2025-04-04 17:50:17,921 - INFO - R²差异: 0.0001
2025-04-04 17:50:17,921 - INFO - 验证损失减少 (0.001369 --> 0.001369)，保存模型...
2025-04-04 17:50:18,001 - INFO - Fold 1, Epoch 5: Train Loss 0.0018, Val Loss 0.0014, Train R2 -0.0668, Val R2 -0.0604
2025-04-04 17:50:18,001 - INFO - R²差异: 0.0064
2025-04-04 17:50:18,001 - INFO - EarlyStopping 计数器: 1 / 5
2025-04-04 17:50:18,050 - INFO - Fold 1, Epoch 6: Train Loss 0.0018, Val Loss 0.0014, Train R2 -0.0573, Val R2 -0.0608
2025-04-04 17:50:18,050 - INFO - R²差异: 0.0035
2025-04-04 17:50:18,050 - INFO - EarlyStopping 计数器: 2 / 5
2025-04-04 17:50:18,084 - INFO - Fold 1, Epoch 7: Train Loss 0.0018, Val Loss 0.0014, Train R2 -0.0635, Val R2 -0.0612
2025-04-04 17:50:18,084 - INFO - R²差异: 0.0023
2025-04-04 17:50:18,084 - INFO - EarlyStopping 计数器: 3 / 5
2025-04-04 17:50:18,124 - INFO - Fold 1, Epoch 8: Train Loss 0.0018, Val Loss 0.0014, Train R2 -0.0635, Val R2 -0.0616
2025-04-04 17:50:18,124 - INFO - R²差异: 0.0018
2025-04-04 17:50:18,124 - INFO - EarlyStopping 计数器: 4 / 5
2025-04-04 17:50:18,158 - INFO - Fold 1, Epoch 9: Train Loss 0.0018, Val Loss 0.0014, Train R2 -0.0587, Val R2 -0.0617
2025-04-04 17:50:18,160 - INFO - R²差异: 0.0029
2025-04-04 17:50:18,160 - INFO - EarlyStopping 计数器: 5 / 5
2025-04-04 17:50:18,160 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:18,217 - INFO - Fold 1, Epoch 10: Train Loss 0.0025, Val Loss 0.0046, Train R2 -0.5182, Val R2 -2.5401
2025-04-04 17:50:18,217 - INFO - R²差异: 2.0219
2025-04-04 17:50:18,217 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:18,217 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:18,270 - INFO - Fold 1, Epoch 11: Train Loss 0.0041, Val Loss 0.0021, Train R2 -1.4821, Val R2 -0.6110
2025-04-04 17:50:18,270 - INFO - R²差异: 0.8711
2025-04-04 17:50:18,270 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:18,270 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:18,326 - INFO - Fold 1, Epoch 12: Train Loss 0.0050, Val Loss 0.0030, Train R2 -1.9665, Val R2 -1.3107
2025-04-04 17:50:18,326 - INFO - R²差异: 0.6557
2025-04-04 17:50:18,326 - INFO - R²差异超过阈值，重置模型（第 3 次）
2025-04-04 17:50:18,326 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:18,378 - INFO - Fold 1, Epoch 13: Train Loss 0.0034, Val Loss 0.0023, Train R2 -1.0623, Val R2 -0.7431
2025-04-04 17:50:18,378 - INFO - R²差异: 0.3192
2025-04-04 17:50:18,378 - INFO - Early stopping triggered at epoch 13
2025-04-04 17:50:18,476 - INFO - Fold 2, Epoch 1: Train Loss 0.0030, Val Loss 0.0033, Train R2 -0.7534, Val R2 -0.8692
2025-04-04 17:50:18,478 - INFO - R²差异: 0.1158
2025-04-04 17:50:18,478 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:18,478 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:18,551 - INFO - Fold 2, Epoch 2: Train Loss 0.0034, Val Loss 0.0029, Train R2 -0.9724, Val R2 -0.6844
2025-04-04 17:50:18,551 - INFO - R²差异: 0.2880
2025-04-04 17:50:18,551 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:18,551 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:18,632 - INFO - Fold 2, Epoch 3: Train Loss 0.0046, Val Loss 0.0046, Train R2 -1.6708, Val R2 -1.6579
2025-04-04 17:50:18,632 - INFO - R²差异: 0.0129
2025-04-04 17:50:18,632 - INFO - 验证损失减少 (0.004623 --> 0.004623)，保存模型...
2025-04-04 17:50:18,755 - INFO - Fold 2, Epoch 4: Train Loss 0.0046, Val Loss 0.0046, Train R2 -1.6785, Val R2 -1.6548
2025-04-04 17:50:18,755 - INFO - R²差异: 0.0237
2025-04-04 17:50:18,755 - INFO - 验证损失减少 (0.004618 --> 0.004618)，保存模型...
2025-04-04 17:50:18,872 - INFO - Fold 2, Epoch 5: Train Loss 0.0046, Val Loss 0.0046, Train R2 -1.6679, Val R2 -1.6518
2025-04-04 17:50:18,872 - INFO - R²差异: 0.0161
2025-04-04 17:50:18,872 - INFO - 验证损失减少 (0.004613 --> 0.004613)，保存模型...
2025-04-04 17:50:19,021 - INFO - Fold 2, Epoch 6: Train Loss 0.0046, Val Loss 0.0046, Train R2 -1.6649, Val R2 -1.6487
2025-04-04 17:50:19,021 - INFO - R²差异: 0.0162
2025-04-04 17:50:19,021 - INFO - 验证损失减少 (0.004607 --> 0.004607)，保存模型...
2025-04-04 17:50:19,153 - INFO - Fold 2, Epoch 7: Train Loss 0.0046, Val Loss 0.0046, Train R2 -1.6765, Val R2 -1.6456
2025-04-04 17:50:19,153 - INFO - R²差异: 0.0309
2025-04-04 17:50:19,153 - INFO - 验证损失减少 (0.004602 --> 0.004602)，保存模型...
2025-04-04 17:50:19,272 - INFO - Fold 2, Epoch 8: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6559, Val R2 -1.6425
2025-04-04 17:50:19,272 - INFO - R²差异: 0.0133
2025-04-04 17:50:19,272 - INFO - 验证损失减少 (0.004597 --> 0.004597)，保存模型...
2025-04-04 17:50:19,389 - INFO - Fold 2, Epoch 9: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6511, Val R2 -1.6394
2025-04-04 17:50:19,389 - INFO - R²差异: 0.0117
2025-04-04 17:50:19,389 - INFO - 验证损失减少 (0.004591 --> 0.004591)，保存模型...
2025-04-04 17:50:19,504 - INFO - Fold 2, Epoch 10: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6473, Val R2 -1.6363
2025-04-04 17:50:19,504 - INFO - R²差异: 0.0110
2025-04-04 17:50:19,504 - INFO - 验证损失减少 (0.004586 --> 0.004586)，保存模型...
2025-04-04 17:50:19,632 - INFO - Fold 2, Epoch 11: Train Loss 0.0046, Val Loss 0.0046, Train R2 -1.6665, Val R2 -1.6333
2025-04-04 17:50:19,632 - INFO - R²差异: 0.0333
2025-04-04 17:50:19,632 - INFO - 验证损失减少 (0.004581 --> 0.004581)，保存模型...
2025-04-04 17:50:19,764 - INFO - Fold 2, Epoch 12: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6498, Val R2 -1.6302
2025-04-04 17:50:19,764 - INFO - R²差异: 0.0196
2025-04-04 17:50:19,764 - INFO - 验证损失减少 (0.004575 --> 0.004575)，保存模型...
2025-04-04 17:50:19,884 - INFO - Fold 2, Epoch 13: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6413, Val R2 -1.6271
2025-04-04 17:50:19,884 - INFO - R²差异: 0.0141
2025-04-04 17:50:19,884 - INFO - 验证损失减少 (0.004570 --> 0.004570)，保存模型...
2025-04-04 17:50:20,021 - INFO - Fold 2, Epoch 14: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6387, Val R2 -1.6241
2025-04-04 17:50:20,021 - INFO - R²差异: 0.0146
2025-04-04 17:50:20,021 - INFO - 验证损失减少 (0.004565 --> 0.004565)，保存模型...
2025-04-04 17:50:20,135 - INFO - Fold 2, Epoch 15: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6369, Val R2 -1.6210
2025-04-04 17:50:20,135 - INFO - R²差异: 0.0159
2025-04-04 17:50:20,135 - INFO - 验证损失减少 (0.004559 --> 0.004559)，保存模型...
2025-04-04 17:50:20,251 - INFO - Fold 2, Epoch 16: Train Loss 0.0045, Val Loss 0.0046, Train R2 -1.6350, Val R2 -1.6180
2025-04-04 17:50:20,253 - INFO - R²差异: 0.0170
2025-04-04 17:50:20,253 - INFO - 验证损失减少 (0.004554 --> 0.004554)，保存模型...
2025-04-04 17:50:20,366 - INFO - Fold 2, Epoch 17: Train Loss 0.0045, Val Loss 0.0045, Train R2 -1.6175, Val R2 -1.6149
2025-04-04 17:50:20,366 - INFO - R²差异: 0.0026
2025-04-04 17:50:20,366 - INFO - 验证损失减少 (0.004549 --> 0.004549)，保存模型...
2025-04-04 17:50:20,480 - INFO - Fold 2, Epoch 18: Train Loss 0.0045, Val Loss 0.0045, Train R2 -1.6232, Val R2 -1.6118
2025-04-04 17:50:20,480 - INFO - R²差异: 0.0113
2025-04-04 17:50:20,480 - INFO - 验证损失减少 (0.004543 --> 0.004543)，保存模型...
2025-04-04 17:50:20,601 - INFO - Fold 2, Epoch 19: Train Loss 0.0045, Val Loss 0.0045, Train R2 -1.6197, Val R2 -1.6088
2025-04-04 17:50:20,603 - INFO - R²差异: 0.0109
2025-04-04 17:50:20,603 - INFO - 验证损失减少 (0.004538 --> 0.004538)，保存模型...
2025-04-04 17:50:20,733 - INFO - Fold 2, Epoch 20: Train Loss 0.0045, Val Loss 0.0045, Train R2 -1.6116, Val R2 -1.6057
2025-04-04 17:50:20,733 - INFO - R²差异: 0.0059
2025-04-04 17:50:20,733 - INFO - 验证损失减少 (0.004533 --> 0.004533)，保存模型...
2025-04-04 17:50:20,847 - INFO - Fold 2, Epoch 21: Train Loss 0.0045, Val Loss 0.0045, Train R2 -1.6095, Val R2 -1.6026
2025-04-04 17:50:20,847 - INFO - R²差异: 0.0069
2025-04-04 17:50:20,849 - INFO - 验证损失减少 (0.004527 --> 0.004527)，保存模型...
2025-04-04 17:50:20,956 - INFO - Fold 2, Epoch 22: Train Loss 0.0045, Val Loss 0.0045, Train R2 -1.6101, Val R2 -1.5996
2025-04-04 17:50:20,956 - INFO - R²差异: 0.0105
2025-04-04 17:50:20,957 - INFO - 验证损失减少 (0.004522 --> 0.004522)，保存模型...
2025-04-04 17:50:21,069 - INFO - Fold 2, Epoch 23: Train Loss 0.0045, Val Loss 0.0045, Train R2 -1.6071, Val R2 -1.5965
2025-04-04 17:50:21,069 - INFO - R²差异: 0.0106
2025-04-04 17:50:21,069 - INFO - 验证损失减少 (0.004517 --> 0.004517)，保存模型...
2025-04-04 17:50:21,187 - INFO - Fold 2, Epoch 24: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5928, Val R2 -1.5935
2025-04-04 17:50:21,187 - INFO - R²差异: 0.0007
2025-04-04 17:50:21,187 - INFO - 验证损失减少 (0.004511 --> 0.004511)，保存模型...
2025-04-04 17:50:21,299 - INFO - Fold 2, Epoch 25: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.6001, Val R2 -1.5904
2025-04-04 17:50:21,301 - INFO - R²差异: 0.0097
2025-04-04 17:50:21,301 - INFO - 验证损失减少 (0.004506 --> 0.004506)，保存模型...
2025-04-04 17:50:21,417 - INFO - Fold 2, Epoch 26: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5762, Val R2 -1.5874
2025-04-04 17:50:21,417 - INFO - R²差异: 0.0111
2025-04-04 17:50:21,417 - INFO - 验证损失减少 (0.004501 --> 0.004501)，保存模型...
2025-04-04 17:50:21,543 - INFO - Fold 2, Epoch 27: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5743, Val R2 -1.5843
2025-04-04 17:50:21,543 - INFO - R²差异: 0.0100
2025-04-04 17:50:21,543 - INFO - 验证损失减少 (0.004495 --> 0.004495)，保存模型...
2025-04-04 17:50:21,665 - INFO - Fold 2, Epoch 28: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5747, Val R2 -1.5813
2025-04-04 17:50:21,667 - INFO - R²差异: 0.0066
2025-04-04 17:50:21,667 - INFO - 验证损失减少 (0.004490 --> 0.004490)，保存模型...
2025-04-04 17:50:21,793 - INFO - Fold 2, Epoch 29: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5649, Val R2 -1.5783
2025-04-04 17:50:21,793 - INFO - R²差异: 0.0134
2025-04-04 17:50:21,793 - INFO - 验证损失减少 (0.004485 --> 0.004485)，保存模型...
2025-04-04 17:50:21,916 - INFO - Fold 2, Epoch 30: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5771, Val R2 -1.5753
2025-04-04 17:50:21,916 - INFO - R²差异: 0.0018
2025-04-04 17:50:21,916 - INFO - 验证损失减少 (0.004480 --> 0.004480)，保存模型...
2025-04-04 17:50:22,044 - INFO - Fold 2, Epoch 31: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5659, Val R2 -1.5723
2025-04-04 17:50:22,044 - INFO - R²差异: 0.0064
2025-04-04 17:50:22,044 - INFO - 验证损失减少 (0.004474 --> 0.004474)，保存模型...
2025-04-04 17:50:22,181 - INFO - Fold 2, Epoch 32: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5640, Val R2 -1.5693
2025-04-04 17:50:22,181 - INFO - R²差异: 0.0053
2025-04-04 17:50:22,181 - INFO - 验证损失减少 (0.004469 --> 0.004469)，保存模型...
2025-04-04 17:50:22,302 - INFO - Fold 2, Epoch 33: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5598, Val R2 -1.5663
2025-04-04 17:50:22,302 - INFO - R²差异: 0.0066
2025-04-04 17:50:22,302 - INFO - 验证损失减少 (0.004464 --> 0.004464)，保存模型...
2025-04-04 17:50:22,420 - INFO - Fold 2, Epoch 34: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5501, Val R2 -1.5634
2025-04-04 17:50:22,420 - INFO - R²差异: 0.0133
2025-04-04 17:50:22,420 - INFO - 验证损失减少 (0.004459 --> 0.004459)，保存模型...
2025-04-04 17:50:22,529 - INFO - Fold 2, Epoch 35: Train Loss 0.0044, Val Loss 0.0045, Train R2 -1.5488, Val R2 -1.5604
2025-04-04 17:50:22,529 - INFO - R²差异: 0.0116
2025-04-04 17:50:22,529 - INFO - 验证损失减少 (0.004454 --> 0.004454)，保存模型...
2025-04-04 17:50:22,664 - INFO - Fold 2, Epoch 36: Train Loss 0.0044, Val Loss 0.0044, Train R2 -1.5468, Val R2 -1.5575
2025-04-04 17:50:22,664 - INFO - R²差异: 0.0106
2025-04-04 17:50:22,664 - INFO - 验证损失减少 (0.004449 --> 0.004449)，保存模型...
2025-04-04 17:50:22,787 - INFO - Fold 2, Epoch 37: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5432, Val R2 -1.5545
2025-04-04 17:50:22,787 - INFO - R²差异: 0.0113
2025-04-04 17:50:22,787 - INFO - 验证损失减少 (0.004444 --> 0.004444)，保存模型...
2025-04-04 17:50:22,902 - INFO - Fold 2, Epoch 38: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5418, Val R2 -1.5515
2025-04-04 17:50:22,902 - INFO - R²差异: 0.0097
2025-04-04 17:50:22,902 - INFO - 验证损失减少 (0.004438 --> 0.004438)，保存模型...
2025-04-04 17:50:23,018 - INFO - Fold 2, Epoch 39: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5274, Val R2 -1.5486
2025-04-04 17:50:23,018 - INFO - R²差异: 0.0211
2025-04-04 17:50:23,018 - INFO - 验证损失减少 (0.004433 --> 0.004433)，保存模型...
2025-04-04 17:50:23,128 - INFO - Fold 2, Epoch 40: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5325, Val R2 -1.5456
2025-04-04 17:50:23,128 - INFO - R²差异: 0.0131
2025-04-04 17:50:23,128 - INFO - 验证损失减少 (0.004428 --> 0.004428)，保存模型...
2025-04-04 17:50:23,266 - INFO - Fold 2, Epoch 41: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5257, Val R2 -1.5426
2025-04-04 17:50:23,268 - INFO - R²差异: 0.0169
2025-04-04 17:50:23,268 - INFO - 验证损失减少 (0.004423 --> 0.004423)，保存模型...
2025-04-04 17:50:23,386 - INFO - Fold 2, Epoch 42: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5111, Val R2 -1.5396
2025-04-04 17:50:23,386 - INFO - R²差异: 0.0285
2025-04-04 17:50:23,386 - INFO - 验证损失减少 (0.004418 --> 0.004418)，保存模型...
2025-04-04 17:50:23,522 - INFO - Fold 2, Epoch 43: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5200, Val R2 -1.5366
2025-04-04 17:50:23,522 - INFO - R²差异: 0.0166
2025-04-04 17:50:23,522 - INFO - 验证损失减少 (0.004412 --> 0.004412)，保存模型...
2025-04-04 17:50:23,636 - INFO - Fold 2, Epoch 44: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5172, Val R2 -1.5336
2025-04-04 17:50:23,636 - INFO - R²差异: 0.0164
2025-04-04 17:50:23,636 - INFO - 验证损失减少 (0.004407 --> 0.004407)，保存模型...
2025-04-04 17:50:23,760 - INFO - Fold 2, Epoch 45: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5049, Val R2 -1.5306
2025-04-04 17:50:23,760 - INFO - R²差异: 0.0257
2025-04-04 17:50:23,760 - INFO - 验证损失减少 (0.004402 --> 0.004402)，保存模型...
2025-04-04 17:50:23,872 - INFO - Fold 2, Epoch 46: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.5075, Val R2 -1.5276
2025-04-04 17:50:23,874 - INFO - R²差异: 0.0202
2025-04-04 17:50:23,874 - INFO - 验证损失减少 (0.004397 --> 0.004397)，保存模型...
2025-04-04 17:50:23,997 - INFO - Fold 2, Epoch 47: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.4957, Val R2 -1.5246
2025-04-04 17:50:23,997 - INFO - R²差异: 0.0289
2025-04-04 17:50:23,997 - INFO - 验证损失减少 (0.004392 --> 0.004392)，保存模型...
2025-04-04 17:50:24,229 - INFO - Fold 2, Epoch 48: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.4958, Val R2 -1.5216
2025-04-04 17:50:24,229 - INFO - R²差异: 0.0258
2025-04-04 17:50:24,229 - INFO - 验证损失减少 (0.004386 --> 0.004386)，保存模型...
2025-04-04 17:50:24,370 - INFO - Fold 2, Epoch 49: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.4935, Val R2 -1.5187
2025-04-04 17:50:24,370 - INFO - R²差异: 0.0252
2025-04-04 17:50:24,370 - INFO - 验证损失减少 (0.004381 --> 0.004381)，保存模型...
2025-04-04 17:50:24,514 - INFO - Fold 2, Epoch 50: Train Loss 0.0043, Val Loss 0.0044, Train R2 -1.4908, Val R2 -1.5157
2025-04-04 17:50:24,514 - INFO - R²差异: 0.0248
2025-04-04 17:50:24,514 - INFO - 验证损失减少 (0.004376 --> 0.004376)，保存模型...
2025-04-04 17:50:24,635 - INFO - Fold 2, Epoch 51: Train Loss 0.0042, Val Loss 0.0044, Train R2 -1.4815, Val R2 -1.5127
2025-04-04 17:50:24,635 - INFO - R²差异: 0.0311
2025-04-04 17:50:24,635 - INFO - 验证损失减少 (0.004371 --> 0.004371)，保存模型...
2025-04-04 17:50:24,771 - INFO - Fold 2, Epoch 52: Train Loss 0.0042, Val Loss 0.0044, Train R2 -1.4816, Val R2 -1.5097
2025-04-04 17:50:24,771 - INFO - R²差异: 0.0281
2025-04-04 17:50:24,771 - INFO - 验证损失减少 (0.004366 --> 0.004366)，保存模型...
2025-04-04 17:50:24,891 - INFO - Fold 2, Epoch 53: Train Loss 0.0042, Val Loss 0.0044, Train R2 -1.4800, Val R2 -1.5067
2025-04-04 17:50:24,891 - INFO - R²差异: 0.0267
2025-04-04 17:50:24,893 - INFO - 验证损失减少 (0.004360 --> 0.004360)，保存模型...
2025-04-04 17:50:25,020 - INFO - Fold 2, Epoch 54: Train Loss 0.0042, Val Loss 0.0044, Train R2 -1.4790, Val R2 -1.5037
2025-04-04 17:50:25,020 - INFO - R²差异: 0.0247
2025-04-04 17:50:25,020 - INFO - 验证损失减少 (0.004355 --> 0.004355)，保存模型...
2025-04-04 17:50:25,166 - INFO - Fold 2, Epoch 55: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4697, Val R2 -1.5007
2025-04-04 17:50:25,166 - INFO - R²差异: 0.0310
2025-04-04 17:50:25,166 - INFO - 验证损失减少 (0.004350 --> 0.004350)，保存模型...
2025-04-04 17:50:25,301 - INFO - Fold 2, Epoch 56: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4637, Val R2 -1.4977
2025-04-04 17:50:25,303 - INFO - R²差异: 0.0340
2025-04-04 17:50:25,304 - INFO - 验证损失减少 (0.004345 --> 0.004345)，保存模型...
2025-04-04 17:50:25,420 - INFO - Fold 2, Epoch 57: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4618, Val R2 -1.4948
2025-04-04 17:50:25,420 - INFO - R²差异: 0.0330
2025-04-04 17:50:25,420 - INFO - 验证损失减少 (0.004340 --> 0.004340)，保存模型...
2025-04-04 17:50:25,539 - INFO - Fold 2, Epoch 58: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4652, Val R2 -1.4918
2025-04-04 17:50:25,539 - INFO - R²差异: 0.0266
2025-04-04 17:50:25,539 - INFO - 验证损失减少 (0.004334 --> 0.004334)，保存模型...
2025-04-04 17:50:25,659 - INFO - Fold 2, Epoch 59: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4509, Val R2 -1.4889
2025-04-04 17:50:25,659 - INFO - R²差异: 0.0380
2025-04-04 17:50:25,659 - INFO - 验证损失减少 (0.004329 --> 0.004329)，保存模型...
2025-04-04 17:50:25,773 - INFO - Fold 2, Epoch 60: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4364, Val R2 -1.4859
2025-04-04 17:50:25,773 - INFO - R²差异: 0.0495
2025-04-04 17:50:25,776 - INFO - 验证损失减少 (0.004324 --> 0.004324)，保存模型...
2025-04-04 17:50:25,896 - INFO - Fold 2, Epoch 61: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4472, Val R2 -1.4830
2025-04-04 17:50:25,896 - INFO - R²差异: 0.0357
2025-04-04 17:50:25,896 - INFO - 验证损失减少 (0.004319 --> 0.004319)，保存模型...
2025-04-04 17:50:26,018 - INFO - Fold 2, Epoch 62: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4337, Val R2 -1.4800
2025-04-04 17:50:26,018 - INFO - R²差异: 0.0463
2025-04-04 17:50:26,018 - INFO - 验证损失减少 (0.004314 --> 0.004314)，保存模型...
2025-04-04 17:50:26,146 - INFO - Fold 2, Epoch 63: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4438, Val R2 -1.4771
2025-04-04 17:50:26,146 - INFO - R²差异: 0.0332
2025-04-04 17:50:26,146 - INFO - 验证损失减少 (0.004309 --> 0.004309)，保存模型...
2025-04-04 17:50:26,291 - INFO - Fold 2, Epoch 64: Train Loss 0.0042, Val Loss 0.0043, Train R2 -1.4335, Val R2 -1.4742
2025-04-04 17:50:26,291 - INFO - R²差异: 0.0406
2025-04-04 17:50:26,291 - INFO - 验证损失减少 (0.004304 --> 0.004304)，保存模型...
2025-04-04 17:50:26,423 - INFO - Fold 2, Epoch 65: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4170, Val R2 -1.4712
2025-04-04 17:50:26,423 - INFO - R²差异: 0.0543
2025-04-04 17:50:26,423 - INFO - 验证损失减少 (0.004299 --> 0.004299)，保存模型...
2025-04-04 17:50:26,559 - INFO - Fold 2, Epoch 66: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4212, Val R2 -1.4683
2025-04-04 17:50:26,559 - INFO - R²差异: 0.0471
2025-04-04 17:50:26,559 - INFO - 验证损失减少 (0.004294 --> 0.004294)，保存模型...
2025-04-04 17:50:26,683 - INFO - Fold 2, Epoch 67: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4168, Val R2 -1.4654
2025-04-04 17:50:26,683 - INFO - R²差异: 0.0486
2025-04-04 17:50:26,683 - INFO - 验证损失减少 (0.004289 --> 0.004289)，保存模型...
2025-04-04 17:50:26,809 - INFO - Fold 2, Epoch 68: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4182, Val R2 -1.4625
2025-04-04 17:50:26,809 - INFO - R²差异: 0.0443
2025-04-04 17:50:26,810 - INFO - 验证损失减少 (0.004283 --> 0.004283)，保存模型...
2025-04-04 17:50:26,942 - INFO - Fold 2, Epoch 69: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4109, Val R2 -1.4595
2025-04-04 17:50:26,942 - INFO - R²差异: 0.0486
2025-04-04 17:50:26,942 - INFO - 验证损失减少 (0.004278 --> 0.004278)，保存模型...
2025-04-04 17:50:27,060 - INFO - Fold 2, Epoch 70: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4046, Val R2 -1.4566
2025-04-04 17:50:27,060 - INFO - R²差异: 0.0520
2025-04-04 17:50:27,060 - INFO - 验证损失减少 (0.004273 --> 0.004273)，保存模型...
2025-04-04 17:50:27,197 - INFO - Fold 2, Epoch 71: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4049, Val R2 -1.4537
2025-04-04 17:50:27,197 - INFO - R²差异: 0.0488
2025-04-04 17:50:27,197 - INFO - 验证损失减少 (0.004268 --> 0.004268)，保存模型...
2025-04-04 17:50:27,323 - INFO - Fold 2, Epoch 72: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.4015, Val R2 -1.4508
2025-04-04 17:50:27,323 - INFO - R²差异: 0.0493
2025-04-04 17:50:27,325 - INFO - 验证损失减少 (0.004263 --> 0.004263)，保存模型...
2025-04-04 17:50:27,443 - INFO - Fold 2, Epoch 73: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.3984, Val R2 -1.4479
2025-04-04 17:50:27,443 - INFO - R²差异: 0.0495
2025-04-04 17:50:27,443 - INFO - 验证损失减少 (0.004258 --> 0.004258)，保存模型...
2025-04-04 17:50:27,559 - INFO - Fold 2, Epoch 74: Train Loss 0.0041, Val Loss 0.0043, Train R2 -1.3960, Val R2 -1.4450
2025-04-04 17:50:27,559 - INFO - R²差异: 0.0490
2025-04-04 17:50:27,559 - INFO - 验证损失减少 (0.004253 --> 0.004253)，保存模型...
2025-04-04 17:50:27,676 - INFO - Fold 2, Epoch 75: Train Loss 0.0041, Val Loss 0.0042, Train R2 -1.3931, Val R2 -1.4421
2025-04-04 17:50:27,676 - INFO - R²差异: 0.0490
2025-04-04 17:50:27,676 - INFO - 验证损失减少 (0.004248 --> 0.004248)，保存模型...
2025-04-04 17:50:27,785 - INFO - Fold 2, Epoch 76: Train Loss 0.0041, Val Loss 0.0042, Train R2 -1.3839, Val R2 -1.4392
2025-04-04 17:50:27,785 - INFO - R²差异: 0.0553
2025-04-04 17:50:27,785 - INFO - 验证损失减少 (0.004243 --> 0.004243)，保存模型...
2025-04-04 17:50:27,912 - INFO - Fold 2, Epoch 77: Train Loss 0.0041, Val Loss 0.0042, Train R2 -1.3747, Val R2 -1.4363
2025-04-04 17:50:27,912 - INFO - R²差异: 0.0616
2025-04-04 17:50:27,914 - INFO - 验证损失减少 (0.004238 --> 0.004238)，保存模型...
2025-04-04 17:50:28,034 - INFO - Fold 2, Epoch 78: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3698, Val R2 -1.4334
2025-04-04 17:50:28,034 - INFO - R²差异: 0.0636
2025-04-04 17:50:28,034 - INFO - 验证损失减少 (0.004233 --> 0.004233)，保存模型...
2025-04-04 17:50:28,162 - INFO - Fold 2, Epoch 79: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3665, Val R2 -1.4305
2025-04-04 17:50:28,162 - INFO - R²差异: 0.0640
2025-04-04 17:50:28,162 - INFO - 验证损失减少 (0.004228 --> 0.004228)，保存模型...
2025-04-04 17:50:28,287 - INFO - Fold 2, Epoch 80: Train Loss 0.0041, Val Loss 0.0042, Train R2 -1.3836, Val R2 -1.4275
2025-04-04 17:50:28,287 - INFO - R²差异: 0.0439
2025-04-04 17:50:28,287 - INFO - 验证损失减少 (0.004223 --> 0.004223)，保存模型...
2025-04-04 17:50:28,415 - INFO - Fold 2, Epoch 81: Train Loss 0.0041, Val Loss 0.0042, Train R2 -1.3721, Val R2 -1.4246
2025-04-04 17:50:28,415 - INFO - R²差异: 0.0525
2025-04-04 17:50:28,415 - INFO - 验证损失减少 (0.004218 --> 0.004218)，保存模型...
2025-04-04 17:50:28,557 - INFO - Fold 2, Epoch 82: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3600, Val R2 -1.4216
2025-04-04 17:50:28,557 - INFO - R²差异: 0.0616
2025-04-04 17:50:28,557 - INFO - 验证损失减少 (0.004212 --> 0.004212)，保存模型...
2025-04-04 17:50:28,684 - INFO - Fold 2, Epoch 83: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3575, Val R2 -1.4187
2025-04-04 17:50:28,684 - INFO - R²差异: 0.0612
2025-04-04 17:50:28,684 - INFO - 验证损失减少 (0.004207 --> 0.004207)，保存模型...
2025-04-04 17:50:28,809 - INFO - Fold 2, Epoch 84: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3451, Val R2 -1.4157
2025-04-04 17:50:28,809 - INFO - R²差异: 0.0706
2025-04-04 17:50:28,809 - INFO - 验证损失减少 (0.004202 --> 0.004202)，保存模型...
2025-04-04 17:50:28,929 - INFO - Fold 2, Epoch 85: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3532, Val R2 -1.4128
2025-04-04 17:50:28,929 - INFO - R²差异: 0.0596
2025-04-04 17:50:28,929 - INFO - 验证损失减少 (0.004197 --> 0.004197)，保存模型...
2025-04-04 17:50:29,051 - INFO - Fold 2, Epoch 86: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3440, Val R2 -1.4099
2025-04-04 17:50:29,051 - INFO - R²差异: 0.0659
2025-04-04 17:50:29,051 - INFO - 验证损失减少 (0.004192 --> 0.004192)，保存模型...
2025-04-04 17:50:29,163 - INFO - Fold 2, Epoch 87: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3344, Val R2 -1.4069
2025-04-04 17:50:29,163 - INFO - R²差异: 0.0725
2025-04-04 17:50:29,163 - INFO - 验证损失减少 (0.004187 --> 0.004187)，保存模型...
2025-04-04 17:50:29,274 - INFO - Fold 2, Epoch 88: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3316, Val R2 -1.4040
2025-04-04 17:50:29,274 - INFO - R²差异: 0.0725
2025-04-04 17:50:29,276 - INFO - 验证损失减少 (0.004182 --> 0.004182)，保存模型...
2025-04-04 17:50:29,383 - INFO - Fold 2, Epoch 89: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3270, Val R2 -1.4011
2025-04-04 17:50:29,383 - INFO - R²差异: 0.0741
2025-04-04 17:50:29,383 - INFO - 验证损失减少 (0.004177 --> 0.004177)，保存模型...
2025-04-04 17:50:29,510 - INFO - Fold 2, Epoch 90: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3272, Val R2 -1.3981
2025-04-04 17:50:29,510 - INFO - R²差异: 0.0709
2025-04-04 17:50:29,510 - INFO - 验证损失减少 (0.004172 --> 0.004172)，保存模型...
2025-04-04 17:50:29,636 - INFO - Fold 2, Epoch 91: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3279, Val R2 -1.3952
2025-04-04 17:50:29,636 - INFO - R²差异: 0.0673
2025-04-04 17:50:29,638 - INFO - 验证损失减少 (0.004166 --> 0.004166)，保存模型...
2025-04-04 17:50:29,748 - INFO - Fold 2, Epoch 92: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3181, Val R2 -1.3923
2025-04-04 17:50:29,748 - INFO - R²差异: 0.0742
2025-04-04 17:50:29,748 - INFO - 验证损失减少 (0.004161 --> 0.004161)，保存模型...
2025-04-04 17:50:29,870 - INFO - Fold 2, Epoch 93: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3134, Val R2 -1.3893
2025-04-04 17:50:29,870 - INFO - R²差异: 0.0759
2025-04-04 17:50:29,870 - INFO - 验证损失减少 (0.004156 --> 0.004156)，保存模型...
2025-04-04 17:50:29,986 - INFO - Fold 2, Epoch 94: Train Loss 0.0040, Val Loss 0.0042, Train R2 -1.3167, Val R2 -1.3864
2025-04-04 17:50:29,986 - INFO - R²差异: 0.0697
2025-04-04 17:50:29,986 - INFO - 验证损失减少 (0.004151 --> 0.004151)，保存模型...
2025-04-04 17:50:30,102 - INFO - Fold 2, Epoch 95: Train Loss 0.0040, Val Loss 0.0041, Train R2 -1.3183, Val R2 -1.3835
2025-04-04 17:50:30,102 - INFO - R²差异: 0.0652
2025-04-04 17:50:30,102 - INFO - 验证损失减少 (0.004146 --> 0.004146)，保存模型...
2025-04-04 17:50:30,219 - INFO - Fold 2, Epoch 96: Train Loss 0.0039, Val Loss 0.0041, Train R2 -1.3116, Val R2 -1.3805
2025-04-04 17:50:30,219 - INFO - R²差异: 0.0689
2025-04-04 17:50:30,219 - INFO - 验证损失减少 (0.004141 --> 0.004141)，保存模型...
2025-04-04 17:50:30,331 - INFO - Fold 2, Epoch 97: Train Loss 0.0039, Val Loss 0.0041, Train R2 -1.2938, Val R2 -1.3776
2025-04-04 17:50:30,331 - INFO - R²差异: 0.0838
2025-04-04 17:50:30,331 - INFO - 验证损失减少 (0.004136 --> 0.004136)，保存模型...
2025-04-04 17:50:30,437 - INFO - Fold 2, Epoch 98: Train Loss 0.0039, Val Loss 0.0041, Train R2 -1.2998, Val R2 -1.3747
2025-04-04 17:50:30,437 - INFO - R²差异: 0.0749
2025-04-04 17:50:30,437 - INFO - 验证损失减少 (0.004131 --> 0.004131)，保存模型...
2025-04-04 17:50:30,545 - INFO - Fold 2, Epoch 99: Train Loss 0.0039, Val Loss 0.0041, Train R2 -1.3025, Val R2 -1.3718
2025-04-04 17:50:30,545 - INFO - R²差异: 0.0693
2025-04-04 17:50:30,545 - INFO - 验证损失减少 (0.004126 --> 0.004126)，保存模型...
2025-04-04 17:50:30,661 - INFO - Fold 2, Epoch 100: Train Loss 0.0039, Val Loss 0.0041, Train R2 -1.2867, Val R2 -1.3689
2025-04-04 17:50:30,661 - INFO - R²差异: 0.0822
2025-04-04 17:50:30,661 - INFO - 验证损失减少 (0.004121 --> 0.004121)，保存模型...
2025-04-04 17:50:30,849 - INFO - Fold 3, Epoch 1: Train Loss 0.0041, Val Loss 0.0027, Train R2 -1.4945, Val R2 -1.3139
2025-04-04 17:50:30,849 - INFO - R²差异: 0.1806
2025-04-04 17:50:30,849 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:30,849 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:30,943 - INFO - Fold 3, Epoch 2: Train Loss 0.0031, Val Loss 0.0033, Train R2 -0.9055, Val R2 -1.7996
2025-04-04 17:50:30,945 - INFO - R²差异: 0.8940
2025-04-04 17:50:30,945 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:30,945 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:31,046 - INFO - Fold 3, Epoch 3: Train Loss 0.0016, Val Loss 0.0013, Train R2 0.0183, Val R2 -0.1075
2025-04-04 17:50:31,047 - INFO - R²差异: 0.1259
2025-04-04 17:50:31,047 - INFO - R²差异超过阈值，重置模型（第 3 次）
2025-04-04 17:50:31,047 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:31,142 - INFO - Fold 3, Epoch 4: Train Loss 0.0073, Val Loss 0.0081, Train R2 -3.4312, Val R2 -5.8741
2025-04-04 17:50:31,142 - INFO - R²差异: 2.4429
2025-04-04 17:50:31,142 - INFO - Early stopping triggered at epoch 4
2025-04-04 17:50:31,283 - INFO - Fold 4, Epoch 1: Train Loss 0.0025, Val Loss 0.0027, Train R2 -0.6849, Val R2 -0.1343
2025-04-04 17:50:31,286 - INFO - R²差异: 0.5506
2025-04-04 17:50:31,286 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:31,286 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:31,405 - INFO - Fold 4, Epoch 2: Train Loss 0.0019, Val Loss 0.0037, Train R2 -0.2914, Val R2 -0.5729
2025-04-04 17:50:31,405 - INFO - R²差异: 0.2815
2025-04-04 17:50:31,405 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:31,405 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:31,539 - INFO - Fold 4, Epoch 3: Train Loss 0.0030, Val Loss 0.0027, Train R2 -0.9831, Val R2 -0.1537
2025-04-04 17:50:31,539 - INFO - R²差异: 0.8294
2025-04-04 17:50:31,539 - INFO - R²差异超过阈值，重置模型（第 3 次）
2025-04-04 17:50:31,539 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:31,664 - INFO - Fold 4, Epoch 4: Train Loss 0.0042, Val Loss 0.0033, Train R2 -1.7879, Val R2 -0.3898
2025-04-04 17:50:31,666 - INFO - R²差异: 1.3981
2025-04-04 17:50:31,666 - INFO - Early stopping triggered at epoch 4
2025-04-04 17:50:31,838 - INFO - Fold 5, Epoch 1: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0603, Val R2 -0.0081
2025-04-04 17:50:31,838 - INFO - R²差异: 0.0522
2025-04-04 17:50:31,838 - INFO - 验证损失减少 (0.000783 --> 0.000783)，保存模型...
2025-04-04 17:50:32,027 - INFO - Fold 5, Epoch 2: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0576, Val R2 -0.0073
2025-04-04 17:50:32,027 - INFO - R²差异: 0.0503
2025-04-04 17:50:32,027 - INFO - 验证损失减少 (0.000782 --> 0.000782)，保存模型...
2025-04-04 17:50:32,197 - INFO - Fold 5, Epoch 3: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0600, Val R2 -0.0065
2025-04-04 17:50:32,199 - INFO - R²差异: 0.0535
2025-04-04 17:50:32,199 - INFO - 验证损失减少 (0.000782 --> 0.000782)，保存模型...
2025-04-04 17:50:32,388 - INFO - Fold 5, Epoch 4: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0539, Val R2 -0.0058
2025-04-04 17:50:32,388 - INFO - R²差异: 0.0481
2025-04-04 17:50:32,388 - INFO - 验证损失减少 (0.000781 --> 0.000781)，保存模型...
2025-04-04 17:50:32,577 - INFO - Fold 5, Epoch 5: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0544, Val R2 -0.0050
2025-04-04 17:50:32,577 - INFO - R²差异: 0.0494
2025-04-04 17:50:32,577 - INFO - 验证损失减少 (0.000781 --> 0.000781)，保存模型...
2025-04-04 17:50:32,767 - INFO - Fold 5, Epoch 6: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0558, Val R2 -0.0043
2025-04-04 17:50:32,767 - INFO - R²差异: 0.0514
2025-04-04 17:50:32,767 - INFO - 验证损失减少 (0.000780 --> 0.000780)，保存模型...
2025-04-04 17:50:32,968 - INFO - Fold 5, Epoch 7: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0553, Val R2 -0.0036
2025-04-04 17:50:32,968 - INFO - R²差异: 0.0517
2025-04-04 17:50:32,968 - INFO - 验证损失减少 (0.000780 --> 0.000780)，保存模型...
2025-04-04 17:50:33,141 - INFO - Fold 5, Epoch 8: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0522, Val R2 -0.0030
2025-04-04 17:50:33,141 - INFO - R²差异: 0.0493
2025-04-04 17:50:33,141 - INFO - 验证损失减少 (0.000779 --> 0.000779)，保存模型...
2025-04-04 17:50:33,332 - INFO - Fold 5, Epoch 9: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0515, Val R2 -0.0023
2025-04-04 17:50:33,332 - INFO - R²差异: 0.0492
2025-04-04 17:50:33,332 - INFO - 验证损失减少 (0.000779 --> 0.000779)，保存模型...
2025-04-04 17:50:33,532 - INFO - Fold 5, Epoch 10: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0480, Val R2 -0.0017
2025-04-04 17:50:33,532 - INFO - R²差异: 0.0463
2025-04-04 17:50:33,532 - INFO - 验证损失减少 (0.000778 --> 0.000778)，保存模型...
2025-04-04 17:50:33,716 - INFO - Fold 5, Epoch 11: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0487, Val R2 -0.0010
2025-04-04 17:50:33,716 - INFO - R²差异: 0.0476
2025-04-04 17:50:33,716 - INFO - 验证损失减少 (0.000778 --> 0.000778)，保存模型...
2025-04-04 17:50:33,904 - INFO - Fold 5, Epoch 12: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0479, Val R2 -0.0004
2025-04-04 17:50:33,904 - INFO - R²差异: 0.0475
2025-04-04 17:50:33,904 - INFO - 验证损失减少 (0.000777 --> 0.000777)，保存模型...
2025-04-04 17:50:34,092 - INFO - Fold 5, Epoch 13: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0441, Val R2 0.0001
2025-04-04 17:50:34,092 - INFO - R²差异: 0.0442
2025-04-04 17:50:34,092 - INFO - 验证损失减少 (0.000777 --> 0.000777)，保存模型...
2025-04-04 17:50:34,280 - INFO - Fold 5, Epoch 14: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0473, Val R2 0.0007
2025-04-04 17:50:34,280 - INFO - R²差异: 0.0480
2025-04-04 17:50:34,280 - INFO - 验证损失减少 (0.000776 --> 0.000776)，保存模型...
2025-04-04 17:50:34,463 - INFO - Fold 5, Epoch 15: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0443, Val R2 0.0013
2025-04-04 17:50:34,463 - INFO - R²差异: 0.0455
2025-04-04 17:50:34,463 - INFO - 验证损失减少 (0.000776 --> 0.000776)，保存模型...
2025-04-04 17:50:34,659 - INFO - Fold 5, Epoch 16: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0496, Val R2 0.0018
2025-04-04 17:50:34,659 - INFO - R²差异: 0.0515
2025-04-04 17:50:34,659 - INFO - 验证损失减少 (0.000775 --> 0.000775)，保存模型...
2025-04-04 17:50:34,843 - INFO - Fold 5, Epoch 17: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0490, Val R2 0.0023
2025-04-04 17:50:34,843 - INFO - R²差异: 0.0513
2025-04-04 17:50:34,843 - INFO - 验证损失减少 (0.000775 --> 0.000775)，保存模型...
2025-04-04 17:50:35,030 - INFO - Fold 5, Epoch 18: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0477, Val R2 0.0028
2025-04-04 17:50:35,030 - INFO - R²差异: 0.0505
2025-04-04 17:50:35,030 - INFO - 验证损失减少 (0.000775 --> 0.000775)，保存模型...
2025-04-04 17:50:35,223 - INFO - Fold 5, Epoch 19: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0388, Val R2 0.0033
2025-04-04 17:50:35,223 - INFO - R²差异: 0.0421
2025-04-04 17:50:35,223 - INFO - 验证损失减少 (0.000774 --> 0.000774)，保存模型...
2025-04-04 17:50:35,404 - INFO - Fold 5, Epoch 20: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0378, Val R2 0.0038
2025-04-04 17:50:35,404 - INFO - R²差异: 0.0416
2025-04-04 17:50:35,404 - INFO - 验证损失减少 (0.000774 --> 0.000774)，保存模型...
2025-04-04 17:50:35,612 - INFO - Fold 5, Epoch 21: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0424, Val R2 0.0043
2025-04-04 17:50:35,612 - INFO - R²差异: 0.0467
2025-04-04 17:50:35,614 - INFO - 验证损失减少 (0.000774 --> 0.000774)，保存模型...
2025-04-04 17:50:35,799 - INFO - Fold 5, Epoch 22: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0372, Val R2 0.0047
2025-04-04 17:50:35,799 - INFO - R²差异: 0.0419
2025-04-04 17:50:35,799 - INFO - 验证损失减少 (0.000773 --> 0.000773)，保存模型...
2025-04-04 17:50:35,983 - INFO - Fold 5, Epoch 23: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0414, Val R2 0.0051
2025-04-04 17:50:35,983 - INFO - R²差异: 0.0465
2025-04-04 17:50:35,983 - INFO - 验证损失减少 (0.000773 --> 0.000773)，保存模型...
2025-04-04 17:50:36,170 - INFO - Fold 5, Epoch 24: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0385, Val R2 0.0055
2025-04-04 17:50:36,172 - INFO - R²差异: 0.0440
2025-04-04 17:50:36,172 - INFO - 验证损失减少 (0.000773 --> 0.000773)，保存模型...
2025-04-04 17:50:36,348 - INFO - Fold 5, Epoch 25: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0373, Val R2 0.0059
2025-04-04 17:50:36,348 - INFO - R²差异: 0.0432
2025-04-04 17:50:36,348 - INFO - 验证损失减少 (0.000772 --> 0.000772)，保存模型...
2025-04-04 17:50:36,525 - INFO - Fold 5, Epoch 26: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0369, Val R2 0.0063
2025-04-04 17:50:36,528 - INFO - R²差异: 0.0432
2025-04-04 17:50:36,528 - INFO - 验证损失减少 (0.000772 --> 0.000772)，保存模型...
2025-04-04 17:50:36,726 - INFO - Fold 5, Epoch 27: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0369, Val R2 0.0067
2025-04-04 17:50:36,726 - INFO - R²差异: 0.0436
2025-04-04 17:50:36,726 - INFO - 验证损失减少 (0.000772 --> 0.000772)，保存模型...
2025-04-04 17:50:36,921 - INFO - Fold 5, Epoch 28: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0326, Val R2 0.0070
2025-04-04 17:50:36,921 - INFO - R²差异: 0.0396
2025-04-04 17:50:36,921 - INFO - 验证损失减少 (0.000771 --> 0.000771)，保存模型...
2025-04-04 17:50:37,111 - INFO - Fold 5, Epoch 29: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0321, Val R2 0.0073
2025-04-04 17:50:37,111 - INFO - R²差异: 0.0395
2025-04-04 17:50:37,113 - INFO - 验证损失减少 (0.000771 --> 0.000771)，保存模型...
2025-04-04 17:50:37,309 - INFO - Fold 5, Epoch 30: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0345, Val R2 0.0077
2025-04-04 17:50:37,311 - INFO - R²差异: 0.0422
2025-04-04 17:50:37,311 - INFO - 验证损失减少 (0.000771 --> 0.000771)，保存模型...
2025-04-04 17:50:37,517 - INFO - Fold 5, Epoch 31: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0315, Val R2 0.0080
2025-04-04 17:50:37,517 - INFO - R²差异: 0.0394
2025-04-04 17:50:37,517 - INFO - 验证损失减少 (0.000771 --> 0.000771)，保存模型...
2025-04-04 17:50:37,713 - INFO - Fold 5, Epoch 32: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0296, Val R2 0.0082
2025-04-04 17:50:37,713 - INFO - R²差异: 0.0378
2025-04-04 17:50:37,713 - INFO - 验证损失减少 (0.000770 --> 0.000770)，保存模型...
2025-04-04 17:50:37,894 - INFO - Fold 5, Epoch 33: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0309, Val R2 0.0085
2025-04-04 17:50:37,894 - INFO - R²差异: 0.0394
2025-04-04 17:50:37,894 - INFO - 验证损失减少 (0.000770 --> 0.000770)，保存模型...
2025-04-04 17:50:38,065 - INFO - Fold 5, Epoch 34: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0322, Val R2 0.0088
2025-04-04 17:50:38,065 - INFO - R²差异: 0.0410
2025-04-04 17:50:38,065 - INFO - 验证损失减少 (0.000770 --> 0.000770)，保存模型...
2025-04-04 17:50:38,270 - INFO - Fold 5, Epoch 35: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0251, Val R2 0.0090
2025-04-04 17:50:38,270 - INFO - R²差异: 0.0341
2025-04-04 17:50:38,270 - INFO - 验证损失减少 (0.000770 --> 0.000770)，保存模型...
2025-04-04 17:50:38,463 - INFO - Fold 5, Epoch 36: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0265, Val R2 0.0093
2025-04-04 17:50:38,463 - INFO - R²差异: 0.0357
2025-04-04 17:50:38,463 - INFO - 验证损失减少 (0.000770 --> 0.000770)，保存模型...
2025-04-04 17:50:38,650 - INFO - Fold 5, Epoch 37: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0290, Val R2 0.0095
2025-04-04 17:50:38,650 - INFO - R²差异: 0.0385
2025-04-04 17:50:38,650 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:38,837 - INFO - Fold 5, Epoch 38: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0276, Val R2 0.0097
2025-04-04 17:50:38,837 - INFO - R²差异: 0.0373
2025-04-04 17:50:38,837 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:39,032 - INFO - Fold 5, Epoch 39: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0307, Val R2 0.0099
2025-04-04 17:50:39,032 - INFO - R²差异: 0.0406
2025-04-04 17:50:39,034 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:39,226 - INFO - Fold 5, Epoch 40: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0282, Val R2 0.0100
2025-04-04 17:50:39,228 - INFO - R²差异: 0.0382
2025-04-04 17:50:39,228 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:39,420 - INFO - Fold 5, Epoch 41: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0275, Val R2 0.0102
2025-04-04 17:50:39,420 - INFO - R²差异: 0.0377
2025-04-04 17:50:39,420 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:39,611 - INFO - Fold 5, Epoch 42: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0225, Val R2 0.0104
2025-04-04 17:50:39,611 - INFO - R²差异: 0.0329
2025-04-04 17:50:39,611 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:39,799 - INFO - Fold 5, Epoch 43: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0228, Val R2 0.0105
2025-04-04 17:50:39,799 - INFO - R²差异: 0.0333
2025-04-04 17:50:39,799 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:39,998 - INFO - Fold 5, Epoch 44: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0238, Val R2 0.0106
2025-04-04 17:50:39,998 - INFO - R²差异: 0.0344
2025-04-04 17:50:39,998 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:40,182 - INFO - Fold 5, Epoch 45: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0191, Val R2 0.0107
2025-04-04 17:50:40,182 - INFO - R²差异: 0.0299
2025-04-04 17:50:40,182 - INFO - 验证损失减少 (0.000769 --> 0.000769)，保存模型...
2025-04-04 17:50:40,363 - INFO - Fold 5, Epoch 46: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0234, Val R2 0.0108
2025-04-04 17:50:40,365 - INFO - R²差异: 0.0342
2025-04-04 17:50:40,365 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:40,571 - INFO - Fold 5, Epoch 47: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0214, Val R2 0.0109
2025-04-04 17:50:40,571 - INFO - R²差异: 0.0323
2025-04-04 17:50:40,571 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:40,772 - INFO - Fold 5, Epoch 48: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0217, Val R2 0.0110
2025-04-04 17:50:40,774 - INFO - R²差异: 0.0327
2025-04-04 17:50:40,774 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:40,964 - INFO - Fold 5, Epoch 49: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0175, Val R2 0.0110
2025-04-04 17:50:40,964 - INFO - R²差异: 0.0285
2025-04-04 17:50:40,964 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:41,147 - INFO - Fold 5, Epoch 50: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0208, Val R2 0.0111
2025-04-04 17:50:41,147 - INFO - R²差异: 0.0319
2025-04-04 17:50:41,147 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:41,339 - INFO - Fold 5, Epoch 51: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0146, Val R2 0.0111
2025-04-04 17:50:41,339 - INFO - R²差异: 0.0257
2025-04-04 17:50:41,339 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:41,524 - INFO - Fold 5, Epoch 52: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0168, Val R2 0.0111
2025-04-04 17:50:41,524 - INFO - R²差异: 0.0280
2025-04-04 17:50:41,524 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:41,713 - INFO - Fold 5, Epoch 53: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0169, Val R2 0.0111
2025-04-04 17:50:41,713 - INFO - R²差异: 0.0280
2025-04-04 17:50:41,713 - INFO - 验证损失减少 (0.000768 --> 0.000768)，保存模型...
2025-04-04 17:50:41,912 - INFO - Fold 5, Epoch 54: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0112, Val R2 0.0111
2025-04-04 17:50:41,912 - INFO - R²差异: 0.0223
2025-04-04 17:50:41,912 - INFO - EarlyStopping 计数器: 1 / 5
2025-04-04 17:50:42,043 - INFO - Fold 5, Epoch 55: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0150, Val R2 0.0111
2025-04-04 17:50:42,043 - INFO - R²差异: 0.0262
2025-04-04 17:50:42,043 - INFO - EarlyStopping 计数器: 2 / 5
2025-04-04 17:50:42,181 - INFO - Fold 5, Epoch 56: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0148, Val R2 0.0111
2025-04-04 17:50:42,181 - INFO - R²差异: 0.0259
2025-04-04 17:50:42,181 - INFO - EarlyStopping 计数器: 3 / 5
2025-04-04 17:50:42,305 - INFO - Fold 5, Epoch 57: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0148, Val R2 0.0110
2025-04-04 17:50:42,305 - INFO - R²差异: 0.0258
2025-04-04 17:50:42,305 - INFO - EarlyStopping 计数器: 4 / 5
2025-04-04 17:50:42,444 - INFO - Fold 5, Epoch 58: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0134, Val R2 0.0110
2025-04-04 17:50:42,444 - INFO - R²差异: 0.0244
2025-04-04 17:50:42,444 - INFO - EarlyStopping 计数器: 5 / 5
2025-04-04 17:50:42,444 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:42,591 - INFO - Fold 5, Epoch 59: Train Loss 0.0018, Val Loss 0.0012, Train R2 -0.0653, Val R2 -0.4888
2025-04-04 17:50:42,591 - INFO - R²差异: 0.4234
2025-04-04 17:50:42,591 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:42,591 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:42,735 - INFO - Fold 5, Epoch 60: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0609, Val R2 -0.0134
2025-04-04 17:50:42,737 - INFO - R²差异: 0.0475
2025-04-04 17:50:42,737 - INFO - EarlyStopping 计数器: 6 / 5
2025-04-04 17:50:42,737 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:42,892 - INFO - Fold 5, Epoch 61: Train Loss 0.0050, Val Loss 0.0051, Train R2 -2.0244, Val R2 -5.5036
2025-04-04 17:50:42,892 - INFO - R²差异: 3.4792
2025-04-04 17:50:42,892 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:42,892 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:43,047 - INFO - Fold 5, Epoch 62: Train Loss 0.0016, Val Loss 0.0008, Train R2 -0.0011, Val R2 -0.0529
2025-04-04 17:50:43,047 - INFO - R²差异: 0.0518
2025-04-04 17:50:43,047 - INFO - EarlyStopping 计数器: 7 / 5
2025-04-04 17:50:43,047 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:43,207 - INFO - Fold 5, Epoch 63: Train Loss 0.0033, Val Loss 0.0021, Train R2 -1.0049, Val R2 -1.6932
2025-04-04 17:50:43,207 - INFO - R²差异: 0.6883
2025-04-04 17:50:43,207 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:43,207 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:43,347 - INFO - Fold 5, Epoch 64: Train Loss 0.0050, Val Loss 0.0052, Train R2 -2.0632, Val R2 -5.6727
2025-04-04 17:50:43,347 - INFO - R²差异: 3.6094
2025-04-04 17:50:43,347 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:43,349 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:43,497 - INFO - Fold 5, Epoch 65: Train Loss 0.0018, Val Loss 0.0008, Train R2 -0.0987, Val R2 -0.0580
2025-04-04 17:50:43,497 - INFO - R²差异: 0.0407
2025-04-04 17:50:43,497 - INFO - EarlyStopping 计数器: 8 / 5
2025-04-04 17:50:43,497 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:43,664 - INFO - Fold 5, Epoch 66: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0483, Val R2 -0.0005
2025-04-04 17:50:43,664 - INFO - R²差异: 0.0478
2025-04-04 17:50:43,664 - INFO - EarlyStopping 计数器: 9 / 5
2025-04-04 17:50:43,664 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:43,806 - INFO - Fold 5, Epoch 67: Train Loss 0.0023, Val Loss 0.0019, Train R2 -0.3797, Val R2 -1.4756
2025-04-04 17:50:43,806 - INFO - R²差异: 1.0960
2025-04-04 17:50:43,806 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:43,806 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:43,959 - INFO - Fold 5, Epoch 68: Train Loss 0.0020, Val Loss 0.0013, Train R2 -0.2301, Val R2 -0.6245
2025-04-04 17:50:43,959 - INFO - R²差异: 0.3944
2025-04-04 17:50:43,960 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:43,960 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:44,272 - INFO - Fold 5, Epoch 69: Train Loss 0.0021, Val Loss 0.0010, Train R2 -0.2891, Val R2 -0.3218
2025-04-04 17:50:44,272 - INFO - R²差异: 0.0327
2025-04-04 17:50:44,272 - INFO - EarlyStopping 计数器: 10 / 5
2025-04-04 17:50:44,272 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:44,441 - INFO - Fold 5, Epoch 70: Train Loss 0.0039, Val Loss 0.0025, Train R2 -1.3898, Val R2 -2.2081
2025-04-04 17:50:44,442 - INFO - R²差异: 0.8183
2025-04-04 17:50:44,442 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:44,442 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:44,610 - INFO - Fold 5, Epoch 71: Train Loss 0.0017, Val Loss 0.0008, Train R2 -0.0155, Val R2 -0.0385
2025-04-04 17:50:44,610 - INFO - R²差异: 0.0229
2025-04-04 17:50:44,612 - INFO - EarlyStopping 计数器: 11 / 5
2025-04-04 17:50:44,612 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:44,778 - INFO - Fold 5, Epoch 72: Train Loss 0.0049, Val Loss 0.0050, Train R2 -1.9616, Val R2 -5.4063
2025-04-04 17:50:44,778 - INFO - R²差异: 3.4447
2025-04-04 17:50:44,778 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:50:44,780 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:44,938 - INFO - Fold 5, Epoch 73: Train Loss 0.0022, Val Loss 0.0017, Train R2 -0.3355, Val R2 -1.1241
2025-04-04 17:50:44,938 - INFO - R²差异: 0.7886
2025-04-04 17:50:44,938 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:50:44,938 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:45,094 - INFO - Fold 5, Epoch 74: Train Loss 0.0018, Val Loss 0.0010, Train R2 -0.0642, Val R2 -0.2891
2025-04-04 17:50:45,094 - INFO - R²差异: 0.2248
2025-04-04 17:50:45,094 - INFO - R²差异超过阈值，重置模型（第 3 次）
2025-04-04 17:50:45,094 - INFO - R2差异过大，重置模型...
2025-04-04 17:50:45,255 - INFO - Fold 5, Epoch 75: Train Loss 0.0030, Val Loss 0.0016, Train R2 -0.8106, Val R2 -1.1177
2025-04-04 17:50:45,255 - INFO - R²差异: 0.3071
2025-04-04 17:50:45,255 - INFO - Early stopping triggered at epoch 75
2025-04-04 17:51:18,990 - INFO - 随机森林最佳参数: {'max_depth': 10, 'max_features': 'sqrt', 'min_samples_leaf': 10, 'min_samples_split': 20, 'n_estimators': 200}
2025-04-04 17:51:18,990 - INFO - 随机森林训练集 R²: 0.4564, 测试集 R²: 0.0800
2025-04-04 17:51:18,990 - WARNING - R²差异 0.3764 超过阈值 0.1，重新训练模型...
2025-04-04 17:51:23,952 - INFO - Epoch 1: Train Loss 0.3355, Val Loss 0.0796, Train R2 -202.1800, Val R2 -67.3242
2025-04-04 17:51:23,952 - INFO - R²差异: 134.8558
2025-04-04 17:51:23,952 - INFO - R²差异超过阈值，重置模型（第 1 次）
2025-04-04 17:51:23,952 - INFO - R2差异过大，重置模型...
2025-04-04 17:51:23,968 - INFO - Epoch 2: Train Loss 1.3291, Val Loss 0.1045, Train R2 -803.9769, Val R2 -88.7020
2025-04-04 17:51:23,968 - INFO - R²差异: 715.2749
2025-04-04 17:51:23,968 - INFO - R²差异超过阈值，重置模型（第 2 次）
2025-04-04 17:51:23,968 - INFO - R2差异过大，重置模型...
2025-04-04 17:51:23,986 - INFO - Epoch 3: Train Loss 0.2828, Val Loss 0.0064, Train R2 -170.3145, Val R2 -4.5130
2025-04-04 17:51:23,986 - INFO - R²差异: 165.8014
2025-04-04 17:51:23,986 - INFO - R²差异超过阈值，重置模型（第 3 次）
2025-04-04 17:51:23,986 - INFO - R2差异过大，重置模型...
2025-04-04 17:51:24,002 - INFO - Epoch 4: Train Loss 0.5305, Val Loss 0.0258, Train R2 -320.2909, Val R2 -21.1667
2025-04-04 17:51:24,002 - INFO - R²差异: 299.1242
2025-04-04 17:51:24,002 - INFO - Early stopping triggered at epoch 4
2025-04-04 17:51:24,044 - INFO - 正在使用 东富龙（300171）的模型进行预测和回测...
2025-04-04 17:51:24,371 - INFO - 300171股票数据已更新并保存到本地: stock_data\300171.csv
2025-04-04 17:51:24,374 - INFO - 加载本地新闻数据: stock_data\financial_news.csv
2025-04-04 17:51:24,614 - INFO - 新闻数据已更新并保存到本地: stock_data\financial_news.csv
2025-04-04 17:51:24,628 - INFO - 加载本地沪深300指数数据: stock_data\hs300.csv
2025-04-04 17:51:35,056 - INFO - 沪深300指数数据已更新并保存到本地: stock_data\hs300.csv
2025-04-04 17:51:35,062 - INFO - 加载本地行业信息缓存数据...
2025-04-04 17:51:35,768 - INFO - 股票 300171 行业信息: 医疗器械
2025-04-04 17:51:35,773 - INFO - 加载本地财务数据: stock_data\300171_financial.csv
2025-04-04 17:51:36,701 - INFO - 未能获取 300171 在 2025 年的财务数据。
2025-04-04 17:51:36,720 - INFO - 财务数据已更新并保存到本地: stock_data\300171_financial.csv
2025-04-04 17:51:36,724 - INFO - 股票数据长度: 556
2025-04-04 17:51:36,724 - INFO - 沪深300指数数据长度: 278
2025-04-04 17:51:36,724 - INFO - 行业数据长度: 1
2025-04-04 17:51:36,724 - INFO - 财务数据长度: 3
2025-04-04 17:51:36,724 - INFO - 情感特征数据长度: 0
2025-04-04 17:51:36,748 - INFO - 合并后的股票和指数数据已保存到本地文件：merged_stock_index_data.csv
2025-04-04 17:51:36,885 - INFO - 合并后的股票和财务数据已保存到本地文件：merged_stock_financial_data.csv
2025-04-04 17:51:36,889 - WARNING - 情感特征为空，填充默认值。
2025-04-04 17:51:36,955 - INFO - 合并后的股票和情感数据已保存到本地文件：merged_stock_sentiment_data.csv
2025-04-04 17:51:36,973 - INFO - 创建特征工程...
2025-04-04 17:51:36,997 - INFO - 动态生成 Future_Return 列
2025-04-04 17:51:36,999 - INFO - 所有模型文件已加载，准备进行预测...
2025-04-04 17:51:37,017 - INFO - 动态生成 Future_Return 列
2025-04-04 17:51:37,017 - WARNING - 标准化器未加载，跳过数据标准化
2025-04-04 17:51:37,017 - INFO - 特征数据长度: 278
2025-04-04 17:51:37,017 - INFO - 标准化后特征数据长度: 278
2025-04-04 17:51:37,017 - INFO - LSTM模型输入特征数据形状: torch.Size([268, 10, 25])
2025-04-04 17:51:37,181 - INFO - 模型 0 的预测结果长度: 278
2025-04-04 17:51:37,181 - INFO - 模型 1 的预测结果长度: 278
2025-04-04 17:51:37,181 - INFO - 模型 2 的预测结果长度: 278
2025-04-04 17:51:37,181 - WARNING - 预测结果长度与数据长度不一致，正在对齐...
2025-04-04 17:51:39,241 - WARNING - 特征权重加载失败，使用均匀权重: 'numpy.ndarray' object has no attribute 'columns'
2025-04-04 17:51:39,310 - INFO - Starting Portfolio Value: 10000.00
2025-04-04 17:51:39,468 - ERROR - 程序运行时出错: '<' not supported between instances of 'float' and 'NoneType'
2025-04-04 17:51:39,488 - ERROR - 堆栈信息: Traceback (most recent call last):
  File "C:\Users\Leo\PycharmProjects\RQA2025\main.py", line 2614, in main
    backtest_strategy(data_with_signals)
  File "C:\Users\Leo\PycharmProjects\RQA2025\main.py", line 2303, in backtest_strategy
    results = cerebro.run()
              ^^^^^^^^^^^^^
  File "C:\Users\Leo\AppData\Roaming\Python\Python311\site-packages\backtrader\cerebro.py", line 1132, in run
    runstrat = self.runstrategies(iterstrat)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Leo\AppData\Roaming\Python\Python311\site-packages\backtrader\cerebro.py", line 1298, in runstrategies
    self._runonce(runstrats)
  File "C:\Users\Leo\AppData\Roaming\Python\Python311\site-packages\backtrader\cerebro.py", line 1700, in _runonce
    strat._oncepost(dt0)
  File "C:\Users\Leo\AppData\Roaming\Python\Python311\site-packages\backtrader\strategy.py", line 309, in _oncepost
    self.next()
  File "C:\Users\Leo\PycharmProjects\RQA2025\main.py", line 2232, in next
    if self.data.close[0] < getattr(self, 'stop_loss_price', 0):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '<' not supported between instances of 'float' and 'NoneType'


进程已结束,退出代码0
